{
  "version": 3,
  "sources": ["../src/vite-plugin.ts"],
  "sourcesContent": ["import { transformSync } from \"@babel/core\";\nimport type { Plugin } from \"vite\";\nimport locatorPlugin from \"./babel-jsx/index.js\";\nimport { transformVueSFC } from \"./vue-transform.js\";\nimport { transformAngularFile } from \"./angular-transform.js\";\n\nexport interface DevToolsPluginOptions {\n  /**\n   * Only apply in these environments\n   * @default [\"development\"]\n   */\n  environments?: string[];\n\n  /**\n   * Component names to ignore (won't get source location attributes)\n   */\n  ignoreComponentNames?: string[];\n\n  /**\n   * File patterns to include (uses picomatch patterns)\n   * @default [/\\.[jt]sx?$/, /\\.vue$/]\n   */\n  include?: (string | RegExp)[];\n\n  /**\n   * File patterns to exclude\n   * @default [/node_modules/, /\\.next/, /\\.nuxt/]\n   */\n  exclude?: (string | RegExp)[];\n\n  /**\n   * Enable Vue SFC support\n   * @default true\n   */\n  vue?: boolean;\n\n  /**\n   * Enable Angular support (.component.html and inline templates)\n   * @default true\n   */\n  angular?: boolean;\n}\n\nconst defaultInclude = [/\\.[jt]sx?$/, /\\.vue$/, /\\.component\\.html$/];\nconst defaultExclude = [/node_modules/, /\\.next/, /\\.nuxt/, /\\.output/];\n\nfunction matchesPattern(\n  id: string,\n  patterns: (string | RegExp)[]\n): boolean {\n  return patterns.some((pattern) => {\n    if (typeof pattern === \"string\") {\n      return id.includes(pattern);\n    }\n    return pattern.test(id);\n  });\n}\n\n/**\n * Vite plugin for @bakdotdev/dev-tools\n *\n * Injects source location data into JSX and Vue template elements,\n * enabling click-to-source functionality in development.\n *\n * Supports:\n * - React (JSX/TSX)\n * - Vue 3 (SFC templates)\n * - Angular 17+ (component templates)\n * - TanStack Start\n * - Nuxt 3\n *\n * @example React / TanStack Start\n * ```ts\n * // vite.config.ts\n * import { defineConfig } from \"vite\";\n * import react from \"@vitejs/plugin-react\";\n * import { devToolsPlugin } from \"@bakdotdev/dev-tools/vite-plugin\";\n *\n * export default defineConfig({\n *   plugins: [\n *     react(),\n *     devToolsPlugin(),\n *   ],\n * });\n * ```\n *\n * @example Vue 3 / Nuxt 3\n * ```ts\n * // vite.config.ts\n * import { defineConfig } from \"vite\";\n * import vue from \"@vitejs/plugin-vue\";\n * import { devToolsPlugin } from \"@bakdotdev/dev-tools/vite-plugin\";\n *\n * export default defineConfig({\n *   plugins: [\n *     vue(),\n *     devToolsPlugin(),\n *   ],\n * });\n * ```\n *\n * @example Nuxt 3 (nuxt.config.ts)\n * ```ts\n * import { devToolsPlugin } from \"@bakdotdev/dev-tools/vite-plugin\";\n *\n * export default defineNuxtConfig({\n *   vite: {\n *     plugins: [devToolsPlugin()],\n *   },\n * });\n * ```\n *\n * @example Angular 17+ (angular.json - uses Vite by default)\n * ```ts\n * // vite.config.ts (if using custom Vite config)\n * import { devToolsPlugin } from \"@bakdotdev/dev-tools/vite-plugin\";\n *\n * export default {\n *   plugins: [devToolsPlugin()],\n * };\n * ```\n */\nexport function devToolsPlugin(options: DevToolsPluginOptions = {}): Plugin {\n  const {\n    environments = [\"development\"],\n    ignoreComponentNames = [],\n    include = defaultInclude,\n    exclude = defaultExclude,\n    vue = true,\n    angular = true,\n  } = options;\n\n  return {\n    name: \"@bakdotdev/dev-tools\",\n    enforce: \"pre\", // Run before other plugins (like @vitejs/plugin-react or @vitejs/plugin-vue)\n\n    async transform(code, id) {\n      // Check environment\n      const env = process.env.NODE_ENV || \"development\";\n      if (!environments.includes(env)) {\n        return null;\n      }\n\n      // Check exclusions first\n      if (matchesPattern(id, exclude)) {\n        return null;\n      }\n\n      // Check file patterns\n      if (!matchesPattern(id, include)) {\n        return null;\n      }\n\n      // Skip files without angle brackets (quick check)\n      if (!code.includes(\"<\") || !code.includes(\">\")) {\n        return null;\n      }\n\n      // Debug logging\n      if (process.env.DEBUG_DEVTOOLS) {\n        console.log(`[@bakdotdev/dev-tools] Processing: ${id}`);\n      }\n\n      // Handle Vue SFC files\n      if (vue && id.endsWith(\".vue\")) {\n        return await transformVueFile(code, id, ignoreComponentNames);\n      }\n\n      // Handle Angular template files\n      if (angular && id.endsWith(\".component.html\")) {\n        return transformAngularHtmlFile(code, id, ignoreComponentNames);\n      }\n\n      // Handle Angular component files with inline templates\n      if (angular && id.endsWith(\".component.ts\") && code.includes(\"@Component\")) {\n        return transformAngularTsFile(code, id, ignoreComponentNames);\n      }\n\n      // Handle JSX/TSX files\n      return transformJsxFile(code, id, ignoreComponentNames);\n    },\n  };\n}\n\n/**\n * Transform an Angular .component.html file\n */\nfunction transformAngularHtmlFile(\n  code: string,\n  id: string,\n  ignoreComponentNames: string[]\n): { code: string; map?: any } | null {\n  try {\n    return transformAngularFile(code, id, { ignoreComponentNames });\n  } catch (error) {\n    console.warn(\n      `[@bakdotdev/dev-tools] Failed to transform Angular template ${id}:`,\n      error instanceof Error ? error.message : String(error)\n    );\n    return null;\n  }\n}\n\n/**\n * Transform an Angular .component.ts file with inline template\n */\nfunction transformAngularTsFile(\n  code: string,\n  id: string,\n  ignoreComponentNames: string[]\n): { code: string; map?: any } | null {\n  try {\n    return transformAngularFile(code, id, { ignoreComponentNames });\n  } catch (error) {\n    console.warn(\n      `[@bakdotdev/dev-tools] Failed to transform Angular component ${id}:`,\n      error instanceof Error ? error.message : String(error)\n    );\n    return null;\n  }\n}\n\n/**\n * Transform a Vue SFC file\n */\nasync function transformVueFile(\n  code: string,\n  id: string,\n  ignoreComponentNames: string[]\n): Promise<{ code: string; map?: any } | null> {\n  try {\n    const result = await transformVueSFC(code, id, { ignoreComponentNames });\n    return result;\n  } catch (error) {\n    console.warn(\n      `[@bakdotdev/dev-tools] Failed to transform Vue file ${id}:`,\n      error instanceof Error ? error.message : String(error)\n    );\n    return null;\n  }\n}\n\n/**\n * Transform a JSX/TSX file using Babel\n */\nfunction transformJsxFile(\n  code: string,\n  id: string,\n  ignoreComponentNames: string[]\n): { code: string; map?: any } | null {\n  try {\n    const result = transformSync(code, {\n      filename: id,\n      sourceMaps: true,\n      sourceFileName: id,\n      babelrc: false,\n      configFile: false,\n      presets: [\n        [\n          \"@babel/preset-typescript\",\n          {\n            isTSX: true,\n            allExtensions: true,\n            onlyRemoveTypeImports: true,\n          },\n        ],\n      ],\n      plugins: [\n        [\n          locatorPlugin,\n          {\n            dataAttribute: \"path\",\n            ignoreComponentNames,\n          },\n        ],\n      ],\n      retainLines: false,\n      compact: false,\n    });\n\n    if (!result || !result.code) {\n      return null;\n    }\n\n    return {\n      code: result.code,\n      map: result.map,\n    };\n  } catch (error) {\n    console.warn(\n      `[@bakdotdev/dev-tools] Failed to transform ${id}:`,\n      error instanceof Error ? error.message : String(error)\n    );\n    return null;\n  }\n}\n\n// Default export for convenience\nexport default devToolsPlugin;\n"],
  "mappings": "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",
  "names": []
}
